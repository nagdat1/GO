// This Pine ScriptÂ® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© gilanns

//@version=5
//
VERSION                   = 'v13'// 2024.3.20

indicator(
  'nagdat',
  shorttitle              = 'nagdat ' + VERSION,
  overlay                 = true,
  max_bars_back           = 5000
  )

//Truncate Function
truncate(number, decimals) =>
    factor = math.pow(10, decimals)
    int(number * factor) / factor

//
// === INPUTS ===
TPSType = input.string('Trailing',   'What TPS should be taken : ', options = ['ATR', 'Trailing', 'Options'])
setupType = input.string('Open/Close', title='What Trading Setup should be taken : ', options=['Open/Close', 'Renko'])
scolor = input(true, title='Show coloured Bars to indicate Trend?')
almaRibbon = input(false, title='Enable Ribbon?')
//tradeType = input.string('BOTH', title='What trades should be taken : ', options=['LONG', 'SHORT', 'BOTH', 'NONE'])

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© - Custom Alert Settings
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
alertGroup = "ğŸ”” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª (Alert Settings)"

// ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
enableLongAlert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ LONG", group=alertGroup, inline="1")
enableShortAlert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ SHORT", group=alertGroup, inline="1")
enableLongReverseAlert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ LONG REVERSE", group=alertGroup, inline="2")
enableShortReverseAlert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ SHORT REVERSE", group=alertGroup, inline="2")
enableTP1Alert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ TP1", group=alertGroup, inline="3")
enableTP2Alert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ TP2", group=alertGroup, inline="3")
enableTP3Alert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ TP3", group=alertGroup, inline="4")
enableSLAlert = input.bool(true, "ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡ Stop Loss", group=alertGroup, inline="4")

// Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© (ÙŠÙ…ÙƒÙ† ØªØ®ØµÙŠØµÙ‡Ø§)
customLongMsg = input.string("LONG Entry Signal - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© LONG Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customShortMsg = input.string("SHORT Entry Signal - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© SHORT Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customLongReverseMsg = input.string("LONG REVERSE Entry Signal (Position Reversed) - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© LONG REVERSE Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customShortReverseMsg = input.string("SHORT REVERSE Entry Signal (Position Reversed) - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© SHORT REVERSE Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customTP1Msg = input.string("TP1 Target Reached - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© TP1 Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customTP2Msg = input.string("TP2 Target Reached - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© TP2 Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customTP3Msg = input.string("TP3 Target Reached - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© TP3 Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)
customSLMsg = input.string("Stop Loss Hit - Price: {{close}}", "Ø±Ø³Ø§Ù„Ø© Stop Loss Ø§Ù„Ù…Ø®ØµØµØ©", group=alertGroup)

// === /INPUTS ===

// Display the probabilities in a table
//text01_ = str.tostring(timeframe.multiplier * intRes, '####')

//t = timenow + math.round(ta.change(time) * 25)
//var label lab01 = na
//label.delete(lab01)
//lab01 := label.new(t, close, text=text01_, style=label.style_label_left, yloc=yloc.price, xloc=xloc.bar_time, textalign=text.align_left, textcolor=color.white)

// Constants colours that include fully non-transparent option.
green100 = #008000FF
lime100 = #00FF00FF
red100 = #FF0000FF
blue100 = #0000FFFF
aqua100 = #00FFFFFF
darkred100 = #8B0000FF
gray100 = #808080FF

/////////////////////////////////////////////
// Create non-repainting security function
rp_security(_symbol, _res, _src) =>
    request.security(_symbol, _res, _src[1])

//
f_tfInMinutes() =>
    _tfInMinutes = timeframe.period == '1' ? '3' : timeframe.period == '3' ? '5' : timeframe.period == '5' ? '15' : timeframe.period == '15' ? '30' : timeframe.period == '30' ? '60' : timeframe.period == '60' ? '240' : 'D'
    _tfInMinutes
my_time1 = f_tfInMinutes()

tfmult = 18 //input.int(18, "Input Timeframe Multiplier")

f_resInMinutes() => 
    _resInMinutes = timeframe.multiplier * (
      timeframe.isseconds ? 1. / 60. :
      timeframe.isminutes ? 1.       :
      timeframe.isdaily   ? 1440.    :
      timeframe.isweekly  ? 10080.   :
      timeframe.ismonthly ? 43800.   : na)
my_time = str.tostring(f_resInMinutes()*tfmult)

useSource = close //input.string('Close',   'What Source to be used?', options = ['Close', 'HL2'])

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® - Date Filter Settings
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø®ÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ù‚Ø¨Ù„ Ø´Ù‡Ø±) - Ù…ÙØ¹Ù‘Ù„ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
useAutoStartDate = input.bool(false, "ğŸ”„ ØªÙØ¹ÙŠÙ„ ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®", group="ğŸ“… ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® (Date Filter)", tooltip="Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ØŒ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ÙÙ‚Ø· Ø¶Ù…Ù† Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©")

// Ø­Ø³Ø§Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ù‚Ø¨Ù„ Ø´Ù‡Ø± Ù…Ù† Ø§Ù„Ø¢Ù†)
oneMonthInMillis = 30 * 24 * 60 * 60 * 1000  // ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ 30 ÙŠÙˆÙ… Ø¨Ø§Ù„Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©
autoStartDate = timenow - oneMonthInMillis

// Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø§Ù„Ø£ØµÙ„ÙŠ
manualStartDate = input.time(timestamp("01 Jan 2023 00:00 +0300"), "ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙŠØ¯ÙˆÙŠ", group="ğŸ“… ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® (Date Filter)", tooltip="ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙÙ„ØªØ± (ÙŠÙØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®)")

// Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ù…ÙØ¹Ù„
fromDate = useAutoStartDate ? autoStartDate : manualStartDate

toDate = input.time(timestamp("31 Dec 2099 00:00 +0300"), "ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©", group="ğŸ“… ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® (Date Filter)", tooltip="ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙÙ„ØªØ±")

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¶Ù…Ù† Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
// Ø¹Ù†Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØŒ ÙŠØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„ØªØ± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
enableFilter = useAutoStartDate
tradeDateIsAllowed = not enableFilter or (time >= fromDate and time <= toDate)

filter1 = 'Filter with Atr'
filter2 = 'Filter with RSI'
filter3 = 'Atr or RSI'
filter4 = 'Atr and RSI'
filter5 = 'No Filtering'
filter6 = 'Entry Only in sideways market(By ATR or RSI)'
filter7 = 'Entry Only in sideways market(By ATR and RSI)'
typefilter = input.string(filter5, title='Sideways Filtering Input', options=[filter1, filter2, filter3, filter4, filter5, filter6, filter7], group='Strategy Options')

RSI = truncate(ta.rsi(close, input.int(7, group='RSI Filterring')), 2)
toplimitrsi = input.int(45, title='TOP Limit', group='RSI Filterring')
botlimitrsi = input.int(10, title='BOT Limit', group='RSI Filterring')


//ST = input.bool(true, title='Show Supertrend?', group='Supertrend Indicator')
//period = input.int(1440, group='Supertrend Indicator')
//mult = input.float(2.612, group='Supertrend Indicator')
atrfiltLen = 5 //input.int(5, minval=1, title='atr Length', group='Sideways Filtering Input')
atrMaType = 'EMA' //input.string('EMA', options=['SMA', 'EMA'], group='Sideways Filtering Input', title='atr Moving Average Type')
atrMaLen = 5 //input.int(5, minval=1, title='atr MA Length', group='Sideways Filtering Input')

//filtering
atra = request.security(syminfo.tickerid, '', ta.atr(atrfiltLen))
atrMa = atrMaType == 'EM' ? ta.ema(atra, atrMaLen) : ta.sma(atra, atrMaLen)
updm = ta.change(high)
downdm = -ta.change(low)
plusdm = na(updm) ? na : updm > downdm and updm > 0 ? updm : 0
minusdm = na(downdm) ? na : downdm > updm and downdm > 0 ? downdm : 0

cndSidwayss1 = atra >= atrMa
cndSidwayss2 = RSI > toplimitrsi or RSI < botlimitrsi
cndSidways = cndSidwayss1 or cndSidwayss2
cndSidways1 = cndSidwayss1 and cndSidwayss2
Sidwayss1 = atra <= atrMa
Sidwayss2 = RSI < toplimitrsi and RSI > botlimitrsi
Sidways = Sidwayss1 or Sidwayss2
Sidways1 = Sidwayss1 and Sidwayss2

trendType = typefilter == filter1 ? cndSidwayss1 : typefilter == filter2 ? cndSidwayss2 : typefilter == filter3 ? cndSidways : typefilter == filter4 ? cndSidways1 : typefilter == filter5 ? RSI > 0 : typefilter == filter6 ? Sidways : typefilter == filter7 ? Sidways1 : na

// === /INPUTS ===

tf = my_time  //input('15')

r = ticker.heikinashi(syminfo.tickerid)
openSeriesAlt = request.security(r, tf, open, lookahead=barmerge.lookahead_on)
closeSeriesAlt = request.security(r, tf, close, lookahead=barmerge.lookahead_on)
//openP = plot(almaRibbon ? openSeriesAlt : na, color=color.new(color.lime, 0), linewidth=3)
//closeP = plot(almaRibbon ? closeSeriesAlt : na, color=color.new(color.red, 0), linewidth=3)

BUYOC = ta.crossover(closeSeriesAlt, openSeriesAlt) and setupType == "Open/Close" and trendType
SELLOC = ta.crossunder(closeSeriesAlt, openSeriesAlt) and setupType == "Open/Close" and trendType

//strategy.entry('sell', direction=strategy.short, qty=trade_size, comment='sell', when=sel_entry)
//strategy.entry('buy', direction=strategy.long, qty=trade_size, comment='buy', when=buy_entry)

//trendColour = closeSeriesAlt > openSeriesAlt ? color.green : color.red
//bcolour = closeSeriesAlt > openSeriesAlt ? lime100 : red100
//barcolor(scolor ? bcolour : na, title='Bar Colours')
//closeP = plot(almaRibbon ? closeSeriesAlt : na, title='Close Series', color=color.new(trendColour, 20), linewidth=2, style=plot.style_line)
//openP = plot(almaRibbon ? openSeriesAlt : na, title='Open Series', color=color.new(trendColour, 20), linewidth=2, style=plot.style_line)
//fill(closeP, openP, color=color.new(trendColour, 80))
//

//rt = input(true, title="ATR Based REnko is the Default, UnCheck to use Traditional ATR?")
atrLen = 3 //input.int(3, title="RENKO_ATR", group = "Renko Settings")
isATR = true //input.bool(true, title="RENKO_USE_RENKO_ATR", group = "Renko Settings")
tradLen1 = 1000 //input.int(1000, title="RENKO_TRADITIONAL", group = "Renko Settings")

//Code to be implemented in V2
//mul = input(1, "Number Of minticks")
//value = mul * syminfo.mintick

tradLen = tradLen1 * 1

param = isATR ? ticker.renko(syminfo.tickerid, "ATR", atrLen) : ticker.renko(syminfo.tickerid, "Traditional", tradLen)

renko_close = request.security(param, my_time, close, lookahead=barmerge.lookahead_on)
renko_open = request.security(param, my_time, open, lookahead=barmerge.lookahead_on)

//============================================
//Sniper------------------------------------------------------------------------------------------------------------------------------------- // Signal 2
//============================================

//============================================
//EMA_CROSS-------------------------------------------------------------------------------------------------------------------------------- // Signal 4
//============================================

EMA1_length=input.int(2, "EMA1_length", group = "Renko Settings")
EMA2_length=input.int(10, "EMA2_length", group = "Renko Settings")

a = ta.ema(renko_close, EMA1_length)
b = ta.ema(renko_close, EMA2_length)

//BUY = ta.cross(a, b) and a > b and renko_open < renko_close
//SELL = ta.cross(a, b) and a < b and renko_close < renko_open
///////////////////////////////
// Determine long and short conditions
BUYR = ta.crossover(a, b) and setupType == "Renko" and trendType
SELLR = ta.crossunder(a, b) and setupType == "Renko" and trendType

sel_color = setupType == "Open/Close" ? closeSeriesAlt < openSeriesAlt : setupType == "Renko" ? renko_close < renko_open : na
buy_color = setupType == "Open/Close" ? closeSeriesAlt > openSeriesAlt : setupType == "Renko" ? renko_close > renko_open : na

sel_entry = setupType == "Open/Close" ? SELLOC : setupType == "Renko" ? SELLR : na
buy_entry = setupType == "Open/Close" ? BUYOC : setupType == "Renko" ? BUYR : na

trendColour = buy_color ? color.green : color.red
bcolour = buy_color ? lime100 : red100
barcolor(scolor ? bcolour : na, title='Bar Colours')

p11=plot(almaRibbon and setupType == "Open/Close" ? closeSeriesAlt : almaRibbon and setupType == "Renko" ? renko_close : na, style=plot.style_circles, linewidth=1, color=color.new(trendColour, 80), title="RENKO_1")
p22=plot(almaRibbon and setupType == "Open/Close" ? openSeriesAlt : almaRibbon and setupType == "Renko" ? renko_open : na, style=plot.style_circles, linewidth=1, color=color.new(trendColour, 80), title="RENKO_2")
fill(p11, p22, color=color.new(trendColour, 50), title="RENKO_fill")

//<triggers>
lxTrigger    = false
sxTrigger    = false

// === /ALERT conditions.
buy = buy_entry //ta.crossover(closeSeriesAlt, openSeriesAlt)
sell = sel_entry //ta.crossunder(closeSeriesAlt, openSeriesAlt)

// Track previous state to prevent duplicate alerts
var bool prevBuyTrigger = false
var bool prevSellTrigger = false

// Only trigger on new signals (not repainting) - ÙŠÙ…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
buySignal = buy and not buy[1] and not prevBuyTrigger
sellSignal = sell and not sell[1] and not prevSellTrigger

// Update previous state after bar confirmation
if barstate.isconfirmed
    prevBuyTrigger := buy
    prevSellTrigger := sell

// Use clean signals for triggers
leTrigger    = buySignal
seTrigger    = sellSignal

varip wasLong = false
varip wasShort = false

if barstate.isconfirmed
    wasLong := false
else 
    if buySignal
        wasLong := true


if barstate.isconfirmed
    wasShort := false
else 
    if sellSignal
        wasShort := true

plotshape(wasLong, color = color.yellow)
plotshape(wasShort, color = color.yellow)

//plotshape(almaRibbon ? buy : na,  title = "Buy",  text = 'Buy',  style = shape.labelup,   location = location.belowbar, color= #39ff14, textcolor = #FFFFFF, size = size.tiny)
//plotshape(almaRibbon ? sell : na, title = "Exit", text = 'Exit', style = shape.labeldown, location = location.abovebar, color= #ff1100, textcolor = #FFFFFF, size = size.tiny)

// ØªØªØ¨Ø¹ Ø¹Ø¯Ø¯ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ§Ù„Ø¨ÙŠØ¹ (Ù„Ù„Ù…Ø¤Ø´Ø± ÙÙ‚Ø· - Ù„Ø§ ØªØªØ¨Ø¹ ØµÙÙ‚Ø§Øª ÙØ¹Ù„ÙŠØ©)
var int longSignalsCount = 0
var int shortSignalsCount = 0

// ØªØªØ¨Ø¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª
if buySignal
    longSignalsCount := longSignalsCount + 1
if sellSignal
    shortSignalsCount := shortSignalsCount + 1

// === INDICATOR ===
// Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ (Ù„Ù„Ù…Ø¤Ø´Ø± ÙÙ‚Ø· - Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø§Øª ÙØ¹Ù„ÙŠØ©)


G_RISK       = 'â–  ' + 'Risk Management'
//#region â€”â€”â€”â€” <â†“â†“â†“ G_RISK â†“â†“â†“> {

//ATR SL Settings
atrLength = 20 //input.int(20, minval=1, title='ATR Length')
profitFactor = 2.5 //input(2.5, title='Take Profit Factor')
stopFactor = 1 //input(1.0, title='Stop Loss Factor')

// Calculate ATR
tpatrValue = ta.atr(atrLength)

// Calculate take profit and stop loss levels for buy signals
takeProfit1_buy = 1 * profitFactor * tpatrValue //close + profitFactor * atrValue
takeProfit2_buy = 2 * profitFactor * tpatrValue //close + 2 * profitFactor * atrValue
takeProfit3_buy = 3 * profitFactor * tpatrValue //close + 3 * profitFactor * atrValue
stopLoss_buy = close - takeProfit1_buy //stopFactor * tpatrValue

// Calculate take profit and stop loss levels for sell signals
takeProfit1_sell = 1 * profitFactor * tpatrValue //close - profitFactor * atrValue
takeProfit2_sell = 2 * profitFactor * tpatrValue //close - 2 * profitFactor * atrValue
takeProfit3_sell = 3 * profitFactor * tpatrValue //close - 3 * profitFactor * atrValue
stopLoss_sell = close + takeProfit1_sell //stopFactor * tpatrValue

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <constant_declarations>
//Tooltip
T_LVL        = '(%) Exit Level'
T_QTY        = '(%) Adjust trade exit volume'

// on whole pips) for forex currency pairs.
pip_size = syminfo.mintick * (syminfo.type == "forex" ? 10 : 1)

// On the last historical bar, show the instrument's pip size
//if barstate.islastconfirmedhistory
//    label.new(x=bar_index + 2, y=close, style=label.style_label_left,
//         color=color.navy, textcolor=color.white, size=size.large, 
//         text=syminfo.ticker + "'s pip size is:\n" + 
//             str.tostring(pip_size))
// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <input>          |           |                               |                        Line length guide |
i_lxLvlTP1   = leTrigger ? takeProfit1_buy : seTrigger ? takeProfit1_sell : na //input.float     (1,         'Level TP1'                     , group = G_RISK,     tooltip =                   T_LVL)
i_lxQtyTP1   = input.float (50,        'Qty   TP1'                     , group = G_RISK,     tooltip =                   T_QTY)
i_lxLvlTP2   = leTrigger ? takeProfit2_buy : seTrigger ? takeProfit2_sell : na //input.float     (1.5,       'Level TP2'                     , group = G_RISK,     tooltip =                   T_LVL)
i_lxQtyTP2   = input.float (30,        'Qty   TP2'                     , group = G_RISK,     tooltip =                   T_QTY)
i_lxLvlTP3   = leTrigger ? takeProfit3_buy : seTrigger ? takeProfit3_sell : na //input.float     (2,         'Level TP3'                     , group = G_RISK,     tooltip =                   T_LVL)
i_lxQtyTP3   = input.float (20,        'Qty   TP3'                     , group = G_RISK,     tooltip =                   T_QTY)
i_lxLvlSL    = leTrigger ? takeProfit1_buy : seTrigger ? takeProfit1_sell : na //input.float     (0.5,       'Stop Loss'                     , group = G_RISK,     tooltip =                   T_LVL)

i_sxLvlTP1   = i_lxLvlTP1
i_sxQtyTP1   = i_lxQtyTP1
i_sxLvlTP2   = i_lxLvlTP2
i_sxQtyTP2   = i_lxQtyTP2
i_sxLvlTP3   = i_lxLvlTP3
i_sxQtyTP3   = i_lxQtyTP3
i_sxLvlSL    = i_lxLvlSL

i_src        = close

G_DISPLAY    = 'Display'
//<display>
i_alertOn    = true //input.bool       (true,      'Alert Labels On/Off'          , group = G_DISPLAY)
i_barColOn   = true //input.bool       (true,      'Bar Color On/Off'             , group = G_DISPLAY)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© - Ready Alert Messages (Telegram)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¬Ø§Ù‡Ø²Ø© ÙˆÙ…ÙƒØªÙ…Ù„Ø© - ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù‡Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø§Ù„ÙƒÙˆØ¯

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <function_declarations>
// @function        Calculate the Take Profit line, and the crossover or crossunder
f_tp(_condition, _conditionValue, _leTrigger, _seTrigger, _src, _lxLvlTP, _sxLvlTP)=>
    var float _tpLine = 0.0
    _topLvl     = _src + _lxLvlTP //TPSType == "Fixed %" ? _src + (_src * (_lxLvlTP / 100)) : _src + _lxLvlTP
    _botLvl     = _src - _lxLvlTP //TPSType == "Fixed %" ? _src - (_src * (_sxLvlTP / 100)) : _src - _sxLvlTP
    _tpLine    := _condition[1] !=  _conditionValue and _leTrigger ? _topLvl :
                  _condition[1] != -_conditionValue and _seTrigger ? _botLvl :
                  nz(_tpLine[1])
    [_tpLine]

// @function        Similar to "ta.crossover" or "ta.crossunder"
f_cross(_scr1, _scr2, _over)=>
    _cross   = _over ? _scr1 > _scr2 and _scr1[1] < _scr2[1] :
                       _scr1 < _scr2 and _scr1[1] > _scr2[1]

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <calculations>
//<set initial values>
var float condition = 0.0
var float slLine    = 0.0
var float entryLine = 0.0

//<entry & exit orders>
entryLine   := leTrigger and condition[1] <=  0.0 ? close :
               seTrigger and condition[1] >=  0.0 ? close : nz(entryLine[1])
//<SL>
slTopLvl    = TPSType == "Fixed %" ? i_src + (i_src * (i_lxLvlSL / 100)) : i_src + i_lxLvlSL
slBotLvl    = TPSType == "Fixed %" ? i_src - (i_src * (i_sxLvlSL / 100)) : i_src - i_lxLvlSL
slLine     := condition[1] <=  0.0 and leTrigger ? slBotLvl :
              condition[1] >=  0.0 and seTrigger ? slTopLvl : nz(slLine[1])
slLong      = f_cross(low,  slLine, false)
slShort     = f_cross(high, slLine, true )
//<TP1, TP2 & TP3>
[tp3Line]    = f_tp(condition, 1.2,leTrigger, seTrigger, i_src, i_lxLvlTP3, i_sxLvlTP3)
[tp2Line]    = f_tp(condition, 1.1,leTrigger, seTrigger, i_src, i_lxLvlTP2, i_sxLvlTP2)
[tp1Line]    = f_tp(condition, 1.0,leTrigger, seTrigger, i_src, i_lxLvlTP1, i_sxLvlTP1)
tp3Long      = f_cross(high, tp3Line, true )
tp3Short     = f_cross(low,  tp3Line, false)
tp2Long      = f_cross(high, tp2Line, true )
tp2Short     = f_cross(low,  tp2Line, false)
tp1Long      = f_cross(high, tp1Line, true )
tp1Short     = f_cross(low,  tp1Line, false)

switch
    leTrigger and condition[1] <=  0.0 => condition :=  1.0
    seTrigger and condition[1] >=  0.0 => condition := -1.0
    tp3Long   and condition[1] ==  1.2 => condition :=  1.3
    tp3Short  and condition[1] == -1.2 => condition := -1.3
    tp2Long   and condition[1] ==  1.1 => condition :=  1.2
    tp2Short  and condition[1] == -1.1 => condition := -1.2
    tp1Long   and condition[1] ==  1.0 => condition :=  1.1
    tp1Short  and condition[1] == -1.0 => condition := -1.1
    slLong    and condition[1] >=  1.0 => condition :=  0.0
    slShort   and condition[1] <= -1.0 => condition :=  0.0
    lxTrigger and condition[1] >=  1.0 => condition :=  0.0
    sxTrigger and condition[1] <= -1.0 => condition :=  0.0

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”„ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¹ÙƒØ³ (REVERSE) - Ø¹Ù†Ø¯Ù…Ø§ ØªØ¹ÙƒØ³ Ø§Ù„ØµÙÙ‚Ø© Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ TP3 Ø£Ùˆ SL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† TPSType == "Trailing"ØŒ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ ØµÙÙ‚Ø© Ù…ÙØªÙˆØ­Ø© ÙˆØ¬Ø§Ø¡Øª Ø¥Ø´Ø§Ø±Ø© Ø¹ÙƒØ³ÙŠØ©
// ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙÙ‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆÙØªØ­ ØµÙÙ‚Ø© Ø¹ÙƒØ³ÙŠØ© (ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©)
// Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ØªØ³Ù…Ù‰ REVERSE Ù„ØªØªÙ…ÙŠØ² Ø¹Ù† Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
//
// Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¹ÙƒØ³ (ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©):
// - Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Short Ù…ÙØªÙˆØ­ (condition[1] < 0) ÙˆØ¬Ø§Ø¡ buySignal â†’ Ø¥ØºÙ„Ø§Ù‚ Short + ÙØªØ­ Long (REVERSE)
// - Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Long Ù…ÙØªÙˆØ­ (condition[1] > 0) ÙˆØ¬Ø§Ø¡ sellSignal â†’ Ø¥ØºÙ„Ø§Ù‚ Long + ÙØªØ­ Short (REVERSE)

// Ø¥Ø´Ø§Ø±Ø© Long Ø¹ÙƒØ³ÙŠØ©: Ø¹Ù†Ø¯Ù…Ø§ ØªØ£ØªÙŠ Ø¥Ø´Ø§Ø±Ø© Buy Ø£Ø«Ù†Ø§Ø¡ ÙˆØ¬ÙˆØ¯ ØµÙÙ‚Ø© Short Ù…ÙØªÙˆØ­Ø©
// Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ: Close Short + Open Long ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
longE_Reverse = leTrigger and condition[1] < 0.0 and condition == 1.0 and TPSType == "Trailing"

// Ø¥Ø´Ø§Ø±Ø© Short Ø¹ÙƒØ³ÙŠØ©: Ø¹Ù†Ø¯Ù…Ø§ ØªØ£ØªÙŠ Ø¥Ø´Ø§Ø±Ø© Sell Ø£Ø«Ù†Ø§Ø¡ ÙˆØ¬ÙˆØ¯ ØµÙÙ‚Ø© Long Ù…ÙØªÙˆØ­Ø©
// Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ: Close Long + Open Short ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
shortE_Reverse = seTrigger and condition[1] > 0.0 and condition == -1.0 and TPSType == "Trailing"

// Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ­Ø¯Ø« Ø§Ù„Ø¹ÙƒØ³ØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø§Ø±Ø© Close Ù…Ù†ÙØµÙ„Ø©
// Ù„Ø£Ù† Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ ÙˆØ§Ù„ÙØªØ­ ÙŠØ­Ø¯Ø«Ø§Ù† ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª (ÙÙŠ Ø¥Ø´Ø§Ø±Ø© REVERSE ÙˆØ§Ø­Ø¯Ø©)

// Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©: ØªØ­Ø¯Ø« ÙÙ‚Ø· Ø¹Ù†Ø¯Ù…Ø§ Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙÙ‚Ø© Ù…ÙØªÙˆØ­Ø© (condition[1] == 0.0)
// ÙˆÙ„ÙŠØ³ Ù‡Ù†Ø§Ùƒ Ø¥Ø´Ø§Ø±Ø© Ø¹ÙƒØ³ÙŠØ© ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª
longE        = leTrigger and condition[1] ==  0.0 and condition ==  1.0 and not longE_Reverse
shortE       = seTrigger and condition[1] ==  0.0 and condition == -1.0 and not shortE_Reverse
longX        = lxTrigger and condition[1] >=  1.0 and condition ==  0.0
shortX       = sxTrigger and condition[1] <= -1.0 and condition ==  0.0
longSL       = slLong    and condition[1] >=  1.0 and condition ==  0.0
shortSL      = slShort   and condition[1] <= -1.0 and condition ==  0.0
longTP3      = tp3Long   and condition[1] ==  1.2 and condition ==  1.3
shortTP3     = tp3Short  and condition[1] == -1.2 and condition == -1.3
longTP2      = tp2Long   and condition[1] ==  1.1 and condition ==  1.2
shortTP2     = tp2Short  and condition[1] == -1.1 and condition == -1.2
longTP1      = tp1Long   and condition[1] ==  1.0 and condition ==  1.1
shortTP1     = tp1Short  and condition[1] == -1.0 and condition == -1.1

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” ALERT CONDITIONS - Ø´Ø±ÙˆØ· Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ· ÙÙŠ Create Alert ÙÙŠ TradingView
// You can use these conditions in Create Alert in TradingView


// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <visuals>
c_tp         = leTrigger or seTrigger ? na :
               condition == 0.0       ? na : color.green
c_entry      = leTrigger or seTrigger ? na :
               condition == 0.0       ? na : color.blue
c_sl         = leTrigger or seTrigger ? na :
               condition == 0.0       ? na : color.red
p_tp1Line    = plot (  condition ==  1.0 or  condition == -1.0  ?  tp1Line : na,  title      = "TP Line 1",  color      = c_tp,  linewidth  = 1,  style      = plot.style_linebr)
p_tp2Line    = plot (  condition ==  1.0 or  condition == -1.0 or    condition ==  1.1 or  condition == -1.1  ? tp2Line : na,  title      = "TP Line 2",  color      = c_tp,  linewidth  = 1,  style      = plot.style_linebr)
p_tp3Line    = plot (  condition ==  1.0 or  condition == -1.0 or    condition ==  1.1 or  condition == -1.1 or  condition ==  1.2 or  condition == -1.2  ? tp3Line : na,  title      = "TP Line 3",  color      = c_tp,  linewidth  = 1,  style      = plot.style_linebr)
p_entryLine  = plot (  condition >=  1.0 or  condition <= -1.0  ? entryLine : na,  title      = "Entry Line",  color      = c_entry,  linewidth  = 1,  style      = plot.style_linebr)
p_slLine     = plot (  condition ==  1.0 or  condition == -1.0 or    condition ==  1.1 or  condition == -1.1 or  condition ==  1.2 or  condition == -1.2  ? slLine : na,  title      = "SL Line",  color      = c_sl,  linewidth  = 1,  style      = plot.style_linebr)

//fill(  p_tp3Line, p_entryLine,  color      = leTrigger or seTrigger ? na :color.new(color.green, 90))
fill(  p_entryLine, p_slLine,  color      = leTrigger or seTrigger ? na :color.new(color.red, 90))

//<alerts labels>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Š Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Øª (Visual Signals on Chart)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ù…Ù„Ø§Ø­Ø¸Ø©: ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø¥Ø´Ø§Ø±Ø§Øª BUY/SELL Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© - ØªØ¸Ù‡Ø± ÙÙ‚Ø· REVERSE signals
// Note: Regular BUY/SELL signals are hidden - only REVERSE signals are shown

// Ø¥Ø´Ø§Ø±Ø§Øª REVERSE ÙÙ‚Ø· (Long Reverse Ùˆ Short Reverse)
plotshape(  i_alertOn and longE_Reverse,  title      = 'Long Reverse',  text       = 'Long Rev',  textcolor  = color.white,  color      = color.orange,  style      = shape.labelup,  size       = size.tiny,  location   = location.belowbar)
plotshape(  i_alertOn and shortE_Reverse,  title      = 'Short Reverse',  text       = 'Short Rev',  textcolor  = color.white,  color      = color.orange,  style      = shape.labeldown,  size       = size.tiny,  location   = location.abovebar)

// Ø¥Ø´Ø§Ø±Ø§Øª BUY/SELL Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© - Ù…Ø¹Ø·Ù„Ø© (ØºÙŠØ± Ù…Ø±Ø¦ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Øª)
// plotshape(  i_alertOn and longE and not longE_Reverse,  title      = 'Long',  text       = 'Long',  textcolor  = color.white,  color      = color.green,  style      = shape.labelup,  size       = size.tiny,  location   = location.belowbar)
// plotshape(  i_alertOn and shortE and not shortE_Reverse,  title      = 'Short',  text       = 'Short',  textcolor  = color.white,  color      = color.red,  style      = shape.labeldown,  size       = size.tiny,  location   = location.abovebar)
plotshape(  i_alertOn and (longX or shortX) and not longE_Reverse and not shortE_Reverse ? close : na,  title      = 'Close',  text       = 'Close',  textcolor  = color.white,  color      = color.gray,  style      = shape.labelup,  size       = size.tiny,  location   = location.absolute)
l_tp         = i_alertOn and (longTP1 or shortTP1) ? close : na

plotshape(  l_tp,  title      = "TP1 Cross",  text       = "TP1",  textcolor  = color.white,  color      = color.olive,  style      = shape.labelup,  size       = size.tiny,  location   = location.absolute)
plotshape(  i_alertOn and (longTP2 or shortTP2) ? close : na,  title      = "TP2 Cross",  text       = "TP2",  textcolor  = color.white,  color      = color.olive,  style      = shape.labelup,  size       = size.tiny,  location   = location.absolute)
plotshape(  i_alertOn and (longTP3 or shortTP3) ? close : na,  title      = "TP3 Cross",  text       = "TP3",  textcolor  = color.white,  color      = color.olive,  style      = shape.labelup,  size       = size.tiny,  location   = location.absolute)
plotshape(  i_alertOn and (longSL or shortSL) ? close : na,  title      = "SL Cross",  text       = "SL",  textcolor  = color.white,  color      = color.maroon,  style      = shape.labelup,  size       = size.tiny,  location   = location.absolute)

//<debug>
plot(  na,  title      = "â”€â”€â”€ <debug> â”€â”€â”€",  editable   = false,  display    = display.data_window)
plot(  condition,  title      = "condition",  editable   = false,  display    = display.data_window)
//#endregion }
// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <â†‘â†‘â†‘ G_RISK â†‘â†‘â†‘>

//#region â€”â€”â€”â€” <â†“â†“â†“ G_SCRIPT02 â†“â†“â†“> {
// @function        Queues a new element in an array and de-queues its first element.
f_qDq(_array, _val) =>
    array.push(_array, _val)
    _return = array.shift(_array)
    _return

var line[]  a_slLine     = array.new_line(1)
var line[]  a_entryLine  = array.new_line(1)
var line[]  a_tp3Line    = array.new_line(1)
var line[]  a_tp2Line    = array.new_line(1)
var line[]  a_tp1Line    = array.new_line(1)
var label[] a_slLabel    = array.new_label(1)
var label[] a_tp3label   = array.new_label(1)
var label[] a_tp2label   = array.new_label(1)
var label[] a_tp1label   = array.new_label(1)
var label[] a_entryLabel = array.new_label(1)

newEntry     = longE or shortE
entryIndex   = 1
entryIndex   := newEntry ? bar_index : nz(entryIndex[1])
lasTrade     = bar_index >= entryIndex
l_right      = 10

if TPSType == "ATR"
    line.delete(  f_qDq(a_slLine,  line.new(   entryIndex,   slLine,   last_bar_index + l_right,   slLine,   style = line.style_solid,   color = c_sl))) 

if TPSType == "ATR"
    line.delete(  f_qDq(a_entryLine,  line.new(   entryIndex,   entryLine,   last_bar_index + l_right,   entryLine,   style = line.style_solid,   color = color.blue)))

if TPSType == "ATR"
    line.delete(  f_qDq(a_tp3Line,  line.new(   entryIndex,   tp3Line,   last_bar_index + l_right,   tp3Line,   style = line.style_solid,   color = c_tp)))

if TPSType == "ATR"
    line.delete(  f_qDq(a_tp2Line,  line.new(   entryIndex,   tp2Line,   last_bar_index + l_right,   tp2Line,   style = line.style_solid,   color = c_tp)))

if TPSType == "ATR"
    line.delete(  f_qDq(a_tp1Line,  line.new(   entryIndex,   tp1Line,   last_bar_index + l_right,   tp1Line,   style = line.style_solid,   color = c_tp)))

if TPSType == "ATR"
    label.delete(  f_qDq(a_slLabel,  label.new(   last_bar_index + l_right,   slLine,   'SL: ' + str.tostring(slLine, '##.###'),   style = label.style_label_left,   textcolor  = color.white,   color = c_sl)))

if TPSType == "ATR"
    label.delete(  f_qDq(a_entryLabel,  label.new(   last_bar_index + l_right,   entryLine,   'Entry: ' + str.tostring(entryLine, '##.###'),   style = label.style_label_left,   textcolor  = color.white,   color = color.blue)))

if TPSType == "ATR"
    label.delete(  f_qDq(a_tp3label,  label.new(   last_bar_index + l_right,   tp3Line,   'TP3: ' + str.tostring(tp3Line, '##.###') + " - Target Pips : - " + str.tostring(longE ? tp3Line - entryLine : entryLine - tp3Line, "#.##"),   style = label.style_label_left,   textcolor  = color.white,   color = c_tp)))

if TPSType == "ATR"
    label.delete(  f_qDq(a_tp2label,  label.new(   last_bar_index + l_right,   tp2Line,   'TP2: ' + str.tostring(tp2Line, '##.###'),   style = label.style_label_left,   textcolor  = color.white,   color = c_tp)))

if TPSType == "ATR"
    label.delete(  f_qDq(a_tp1label,  label.new(   last_bar_index + l_right,   tp1Line,   'TP1: ' + str.tostring(tp1Line, '##.###'),   style = label.style_label_left,   textcolor  = color.white,   color = c_tp)))

//#endregion }
// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <â†‘â†‘â†‘ G_SCRIPT02 â†‘â†‘â†‘>

c_barCol = close > open ? color.rgb(120, 9, 139) : color.rgb(69, 155, 225)
barcolor(
  i_barColOn ? c_barCol : na)


// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© TraderHalai
// This script was born out of my quest to be able to display strategy back test statistics on charts to allow for easier backtesting on devices that do not natively support backtest engine (such as mobile phones, when I am backtesting from away from my computer). There are already a few good ones on TradingView, but most / many are too complicated for my needs.
//
//Found an excellent display backtest engine by 'The Art of Trading'. This script is a snippet of his hard work, with some very minor tweaks and changes. Much respect to the original author.
//
//Full credit to the original author of this script. It can be found here: https://www.tradingview.com/script/t776tkZv-Hammers-Stars-Strategy/?offer_id=10&aff_id=15271
//
// This script can be copied and airlifted onto existing strategy scripts of your own, and integrates out of the box without implementation of additional functions. I've also added Max Runup, Average Win and Average Loss per trade to the orignal script.
//
//Will look to add in more performance metrics in future, as I further develop this script.
//
//Feel free to use this display panel in your scripts and strategies.

//Thanks and enjoy! :)
//strategy("Strategy BackTest Display Statistics - TraderHalai", overlay=true, default_qty_value= 5, default_qty_type = strategy.percent_of_equity, initial_capital=10000,  commission_type=strategy.commission.percent, commission_value=0.1)

//DEMO basic strategy - Use your own strategy here -  Jaws Mean Reversion from my profile used here
//source = input(title = "Source", defval = close)
    
///////////////////////////// --- BEGIN TESTER CODE --- ////////////////////////
// COPY below into your strategy to enable display
////////////////////////////////////////////////////////////////////////////////


// Declare performance tracking variables (disabled for indicator - strategy stats not available)
drawTester = input.bool(false, "Indicator Signals Count", group='Dashboards', inline="Show Dashboards")
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª - Signal Statistics
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Prepare stats table
var table testTable = table.new(position.top_right, 3, 3, border_width=1)
f_fillCell(_table, _column, _row, _title, _value, _bgcolor, _txtcolor) =>
    _cellText = _title + "\n" + _value
    table.cell(_table, _column, _row, _cellText, bgcolor=_bgcolor, text_color=_txtcolor)
    
// Draw stats table
var bgcolor = color.new(color.black,0)
if drawTester and tradeDateIsAllowed
    if barstate.islastconfirmedhistory
        // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª (Ù„Ù„Ù…Ø¤Ø´Ø± ÙÙ‚Ø·)
        f_fillCell(testTable, 0, 0, "Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø±Ø§Ø¡:", str.tostring(longSignalsCount), bgcolor, color.white)
        f_fillCell(testTable, 0, 1, "Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¨ÙŠØ¹:", str.tostring(shortSignalsCount), bgcolor, color.white)
        f_fillCell(testTable, 0, 2, "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª:", str.tostring(longSignalsCount + shortSignalsCount), bgcolor, color.white)
        
        f_fillCell(testTable, 1, 0, "Long Signals:", str.tostring(longSignalsCount), color.green, color.white)
        f_fillCell(testTable, 1, 1, "Short Signals:", str.tostring(shortSignalsCount), color.red, color.white)
        f_fillCell(testTable, 1, 2, "Total Signals:", str.tostring(longSignalsCount + shortSignalsCount), bgcolor, color.white)
        
        f_fillCell(testTable, 2, 0, "Note:", "Indicator Mode", bgcolor, color.yellow)
        f_fillCell(testTable, 2, 1, "No Strategy", "Stats Available", bgcolor, color.yellow)
// --- END TESTER CODE --- ///////////////


// This Pine Scriptâ„¢ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© niceGear68734

//strategy("Table to filter trades per day",  overlay=true, use_bar_magnifier = true, initial_capital = 5000, calc_on_every_tick = true, calc_on_order_fills = true, commission_type = strategy.commission.cash_per_contract)

//~ ___________________________________________________________________________
//~ !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//~ !!!!!!!!!!!!!!!_________________  START  _________________!!!!!!!!!!!!!!!!!
i_showweeklyPerformance = input.bool(false, 'Weekly Performance', group='Dashboards', inline="Show Dashboards")
//__________________________   User Inputs  ___________________________________
var const string g_table    = "Table Settings"
i_table_pos                 = "Top Left" //input.string(defval = "Top Left", title = "Position", options = ["Bottom Right","Bottom Left", "Top Right", "Top Left"], group = g_table, inline = "1", tooltip = "It sets the location of the table")
i_text_size                 = "Normal" //input.string(defval = "Normal", title = "Set the size of text", options = ["Small", "Normal", "Large"], tooltip = "This option is used to change the size of the text in the table")
var const string g_general  = "General Settings"
i_check_open_close          = "Opened" //input.string("Opened", "Check when the trade :", ["Opened", "Closed"], group = g_general, tooltip = "This parameter defines what to check for. If opened is selected, the results will show the trades that opened on that day. If closed is selected, the results will show the trades that closed on that day")
i_timezone                  = "Exchange" //input.string("Exchange", title = "Set the Timezone", options = ["Exchange","UTC-10","UTC-9","UTC-8","UTC-7","UTC-6","UTC-5","UTC-4","UTC-3","UTC-2","UTC-1","UTC","UTC+1","UTC+2","UTC+3","UTC+4","UTC+5","UTC+6","UTC+7","UTC+8","UTC+9","UTC+10", "UTC+11","UTC+12","UTC+13","UTC+13:45"], group = g_general, tooltip = "You can use this setting whenever you want to change the time that the trade has closed/opened")

//~_____________________________  Switches  ___________________________________
table_pos = switch i_table_pos
    "Bottom Right"  => position.bottom_right
    "Bottom Left"   => position.bottom_left
    "Top Right"     => position.top_right
    "Top Left"      => position.top_left

timezone_setting = i_timezone == "Exchange" ? syminfo.timezone : i_timezone

text_size = switch i_text_size
    "Small"         => size.small
    "Normal"        => size.normal
    "Large"         => size.large

//__________________________   Array Declaration  _____________________________
var string[] t_column_names          = array.from( "", "Sun", "Mon", "Tue", "Wed", "Thur", "Fri", "Sat")  // Columns header names
var string[] t_row_names             = array.from("", "Total Trades", "Loss", "Win", "Win Rate" )  // Rows header names
var t_column_size                    = array.size(t_column_names)
var t_row_size                       = array.size(t_row_names)
var string[] a_closed_trades         = array.new_string()  // Save the total number of trades
var string[]   a_loss_trades         = array.new_string()  // Save the number of losing trades
var string[]   a_win_trades          = array.new_string()  // Save the number of winning trades 
var _a_day_week                      = array.new_int()  // Save the day of the week to split data

// __________________________  Custom Functions  ________________________________
// Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…Ø¹Ø·Ù„Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ù„Ø£Ù†Ù‡Ø§ ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©
// Note: These functions are disabled in indicator mode as they depend on strategy statistics
var trade_number = -1
// if strategy.closedtrades > strategy.closedtrades[1]
//     trade_number += 1

f_strategy_closedtrades_hour() =>
    // Disabled for indicator - returns 0 (dayofweek returns int, so we return 0 instead of na)
    0
    // switch 
    //     i_check_open_close =="Closed" => dayofweek(strategy.closedtrades.exit_time(trade_number), timezone_setting)
    //     i_check_open_close =="Opened"  => dayofweek(strategy.closedtrades.entry_time(trade_number), timezone_setting)

f_data(_i) =>
    var _closed_trades          = 0
    var _loss_trades            = 0
    var _win_trades             = 0
    var _txt_closed_trades      = "" 
    var _txt_loss_trades        = ""
    var _txt_win_trades         = ""

    // Disabled for indicator - returns empty strings
    // if strategy.closedtrades > strategy.closedtrades[1] and f_strategy_closedtrades_hour() == _i
    //     _closed_trades += 1
    //     _txt_closed_trades := str.tostring(_closed_trades)
    // if strategy.losstrades > strategy.losstrades[1]     and f_strategy_closedtrades_hour() == _i
    //     _loss_trades += 1
    //     _txt_loss_trades := str.tostring(_loss_trades)        
    // if strategy.wintrades > strategy.wintrades[1]       and f_strategy_closedtrades_hour() == _i
    //     _win_trades += 1
    //     _txt_win_trades := str.tostring(_win_trades) 
    [_txt_closed_trades, _txt_loss_trades, _txt_win_trades]                                                       


//__________________________
var string[] array1 = array.new_string(5)
var string[] array2 = array.new_string(5)
var string[] array3 = array.new_string(5)
var string[] array4 = array.new_string(5)
var string[] array5 = array.new_string(5)
var string[] array6 = array.new_string(5)
var string[] array7 = array.new_string(5)


f_pass_data_to_array(_i, _array) =>
    [cl, loss, win] = f_data(_i)
    array.set(_array,1 , cl)
    array.set(_array,2,loss)
    array.set(_array,3,win)
    if cl != "" 
        array.set(_array,4,str.tostring(str.tonumber(win) / str.tonumber(cl) * 100 , "##") + " %")
    if cl != "" and win == ""
        array.set(_array,4,"0 %")


for i = 1 to 7 
    switch
        i == 1 => f_pass_data_to_array(i,array1)
        i == 2 => f_pass_data_to_array(i,array2)
        i == 3 => f_pass_data_to_array(i,array3)
        i == 4 => f_pass_data_to_array(i,array4)
        i == 5 => f_pass_data_to_array(i,array5)
        i == 6 => f_pass_data_to_array(i,array6)
        i == 7 => f_pass_data_to_array(i,array7)

f_retrieve_data_to_table(_i, _j) =>
    switch
        _i == 1 => array.get(array1, _j)
        _i == 2 => array.get(array2, _j)
        _i == 3 => array.get(array3, _j)
        _i == 4 => array.get(array4, _j)
        _i == 5 => array.get(array5, _j)
        _i == 6 => array.get(array6, _j)
        _i == 7 => array.get(array7, _j)





//~ ___________________________  Create Table  ________________________________
create_table(_col, _row, _txt) =>
    var table _tbl = table.new(position = table_pos, columns = t_column_size , rows = t_row_size, border_width=1)
    color _color = _row == 0 or _col == 0 ? color.rgb(3, 62, 106) : color.rgb(2, 81, 155)
    table.cell(_tbl, _col, _row, _txt, bgcolor = _color, text_color = color.white, text_size = text_size)




//~___________________________  Fill With Data  _______________________________
if barstate.islastconfirmedhistory and i_showweeklyPerformance and tradeDateIsAllowed
    for i = 0 to t_column_size - 1 by 1
        for j = 0 to t_row_size - 1 by 1
            _txt = "" 
            if i >= 0 and j == 0
                _txt := array.get(t_column_names, i)
            if j >= 0 and i == 0
                _txt := array.get(t_row_names, j)
            if  i >= 1 and j >= 1 and j <= 5
                _txt :=  f_retrieve_data_to_table( i , j)
            create_table(i ,j , _txt)


//~ ___________________________  Notice  ______________________________________
if timeframe.in_seconds() > timeframe.in_seconds("D")
    x = table.new(position.middle_center,1,1,color.aqua)
    table.cell_set_text(x,0,0,"Please select lower timeframes (Daily or lower)")

//~ !!!!!!!!!!!!!!!_________________  STOP  _________________!!!!!!!!!!!!!!!!!!
//~ !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
//~ ___________________________________________________________________________


// Global Dashboard Variables
// â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

// Dashboard Table Text Size
i_tableTextSize = "Normal" //input.string(title="Dashboard Size", defval="Normal", options=["Auto",  "Huge",  "Large", "Normal", "Small", "Tiny"], group="Dashboards")
table_text_size(s) =>
    switch s
        "Auto"   => size.auto   
        "Huge"   => size.huge   
        "Large"  => size.large  
        "Normal" => size.normal 
        "Small"  => size.small
        => size.tiny
tableTextSize = table_text_size(i_tableTextSize)

// Monthly Table Performance Dashboard By @QuantNomad
// â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
i_showMonthlyPerformance = input.bool(false, 'Monthly Performance', group='Dashboards', inline="Show Dashboards")
i_monthlyReturnPercision = 2

if i_showMonthlyPerformance and tradeDateIsAllowed
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù…Ø¹Ø·Ù„ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ù„Ø£Ù†Ù‡ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ strategy.equity
    // Note: Monthly Performance table is disabled in indicator mode as it depends on strategy.equity
    new_month = month(time) != month(time[1])
    new_year  = year(time)  != year(time[1])
    
    // eq = strategy.equity  // Disabled for indicator
    eq = close  // Use close price as placeholder (not meaningful for P&L)
    
    bar_pnl = eq / eq[1] - 1
    
    cur_month_pnl = 0.0
    cur_year_pnl  = 0.0
    
    // Current Monthly P&L
    cur_month_pnl := new_month ? 0.0 : 
                     (1 + cur_month_pnl[1]) * (1 + bar_pnl) - 1 
    
    // Current Yearly P&L
    cur_year_pnl := new_year ? 0.0 : 
                     (1 + cur_year_pnl[1]) * (1 + bar_pnl) - 1  
    
    // Arrays to store Yearly and Monthly P&Ls
    var month_pnl  = array.new_float(0)
    var month_time = array.new_int(0)
    
    var year_pnl  = array.new_float(0)
    var year_time = array.new_int(0)
    
    last_computed = false
    
    if (not na(cur_month_pnl[1]) and (new_month or barstate.islastconfirmedhistory))
        if (last_computed[1])
            array.pop(month_pnl)
            array.pop(month_time)
            
        array.push(month_pnl , cur_month_pnl[1])
        array.push(month_time, time[1])
    
    if (not na(cur_year_pnl[1]) and (new_year or barstate.islastconfirmedhistory))
        if (last_computed[1])
            array.pop(year_pnl)
            array.pop(year_time)
            
        array.push(year_pnl , cur_year_pnl[1])
        array.push(year_time, time[1])
    
    last_computed := barstate.islastconfirmedhistory ? true : nz(last_computed[1])
    
    // Monthly P&L Table    
    var monthly_table = table(na)
    
    if (barstate.islastconfirmedhistory)
        monthly_table := table.new(position.bottom_right, columns = 14, rows = array.size(year_pnl) + 1, border_width = 1)
    
        table.cell(monthly_table, 0,  0, "",     bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 1,  0, "Jan",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 2,  0, "Feb",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 3,  0, "Mar",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 4,  0, "Apr",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 5,  0, "May",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 6,  0, "Jun",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 7,  0, "Jul",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 8,  0, "Aug",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 9,  0, "Sep",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 10, 0, "Oct",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 11, 0, "Nov",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 12, 0, "Dec",  bgcolor = #cccccc, text_size=tableTextSize)
        table.cell(monthly_table, 13, 0, "Year", bgcolor = #999999, text_size=tableTextSize)
    
        for yi = 0 to array.size(year_pnl) - 1
            table.cell(monthly_table, 0,  yi + 1, str.tostring(year(array.get(year_time, yi))), bgcolor = #cccccc, text_size=tableTextSize)
            
            y_color = array.get(year_pnl, yi) > 0 ? color.new(color.teal, transp = 40) : color.new(color.gray, transp = 40)
            table.cell(monthly_table, 13, yi + 1, str.tostring(math.round(array.get(year_pnl, yi) * 100, i_monthlyReturnPercision)), bgcolor = y_color, text_color=color.new(color.white, 0),text_size=tableTextSize)
            
        for mi = 0 to array.size(month_time) - 1
            m_row   = year(array.get(month_time, mi))  - year(array.get(year_time, 0)) + 1
            m_col   = month(array.get(month_time, mi)) 
            m_color = array.get(month_pnl, mi) > 0 ? color.new(color.teal, transp = 40) : color.new(color.maroon, transp = 40)
            
            table.cell(monthly_table, m_col, m_row, str.tostring(math.round(array.get(month_pnl, mi) * 100, i_monthlyReturnPercision)), bgcolor = m_color, text_color=color.new(color.white, 0), text_size=tableTextSize)



hide = timeframe.isintraday

// Input for EMA period
emaPeriod = 48 //input.int(48, title="EMA Period")
emaPeriod2 = 2 //input.int(2, title="EME Period 2")
emaPeriod3 = 21 //input.int(21, title="EMA Period")

// Input to toggle EMA Cloud 
showcloud = input.bool(true, title="Plot EMA?", group='EMA & ATR', inline="Show EMA's & ATR")
useHTF = input.bool(true, title = "Use Higher Time Frame?")

matimeframe = useHTF ? my_time1 : ''

// EMA calculations
ema = request.security(syminfo.tickerid, matimeframe, ta.ema(close, emaPeriod))
ema2 = request.security(syminfo.tickerid, matimeframe, ta.ema(close,emaPeriod2))
ema3 = request.security(syminfo.tickerid, matimeframe,ta.ema(close, emaPeriod3))
emaColor = close > ema3 ? color.new(color.rgb(56, 142, 60, 63), 50) : color.new(color.rgb(147, 40, 51, 38), 50)

// Plotting EMA's 
plot_ema1 = plot(hide ? ema : na, style=plot.style_line, color=color.new(color.rgb(255, 255, 255, 100), 50), title="EMA", linewidth=2)
plot_ema2 = plot(hide ? ema2 : na, style=plot.style_line, color=color.new(color.rgb(255, 255, 255, 100), 50), title="EMA", linewidth=1)
plot_ema3 = plot(ema3, style=plot.style_line, color=emaColor, title="EMA", linewidth=1)

// EMA Cloud
cloudColor = ema2 > ema ? color.new(#0f8513, 80) : color.new(#a81414, 80)
cloudColor2 = ema2 > ema3 ? color.new(#0f8513, 50) : color.new(#a81414, 50)
cloudColor := showcloud ? cloudColor : na
fill(plot_ema1, plot_ema2, color=cloudColor, title="EMA Cloud")
fill(plot_ema3, plot_ema2, color=cloudColor, title="EMA Cloud")
/////////////////////////////////////////////////////////////// Â© BackQuant ///////////////////////////////////////////////////////////////
// This Pine Scriptâ„¢ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© BackQuant

//indicator(
// title="DEMA Adjusted Average True Range [BackQuant]", 
// shorttitle = "DEMA ATR [BackQuant]",
// overlay=true, 
// timeframe="", 
// timeframe_gaps=true
// )


// Define User Inputs
showAtr                 =        input.bool(true, "Plot Dema?", group='EMA & ATR', inline="Show EMA's & ATR")
haCandles               =        true //input.bool(true, "Use HA Candles?")
periodDema              =        7 //input.int(7, "Dema Period", group = "Dema Atr")
sourceDema              =        close //input.source(close, "Calculation Source", group = "Dema Atr")
periodAtr               =        14 //input.int(14, "Period", group = "Dema Atr")
factorAtr               =        1.7 //input.float(1.7, "Factor", step = 0.01, group = "Dema Atr")
longColour              =       #00ff00
shortColour             =       #ff0000
/////////////////////////////////////////////////////////////// Â© BackQuant ///////////////////////////////////////////////////////////////
// Use HA Candles?
heikinashi_close = request.security(
 symbol = ticker.heikinashi(syminfo.tickerid),
 timeframe =  timeframe.period,
 expression = close, 
 gaps = barmerge.gaps_off, 
 lookahead = barmerge.lookahead_on
 )

var float source = close
if haCandles == true
    source := heikinashi_close
if haCandles == false
    source := sourceDema 
/////////////////////////////////////////////////////////////// Â© BackQuant ///////////////////////////////////////////////////////////////
// Function
DemaAtrWithBands(periodDema, source, lookback, atrFactor)=>
    ema1   = ta.ema(source,  periodDema)
    ema2   = ta.ema(ema1, periodDema)
    demaOut = 2 * ema1 - ema2

    atr = ta.atr(lookback)
    trueRange = atr * atrFactor 

    DemaAtr = demaOut 
    DemaAtr := nz(DemaAtr[1], DemaAtr)

    trueRangeUpper = demaOut + trueRange
    trueRangeLower  = demaOut - trueRange


    if trueRangeLower > DemaAtr 
        DemaAtr := trueRangeLower
    if trueRangeUpper < DemaAtr 
        DemaAtr := trueRangeUpper
    DemaAtr 

// Function Out
DemaAtr = DemaAtrWithBands(periodDema, source, periodAtr, factorAtr)
/////////////////////////////////////////////////////////////// Â© BackQuant ///////////////////////////////////////////////////////////////
// Conditions
DemaAtrLong = DemaAtr > DemaAtr[1] 
DemaAtrShort = DemaAtr < DemaAtr[1]

// Colour Condtions
var color Trendcolor = #ffffff
if DemaAtrLong
    Trendcolor := longColour
if DemaAtrShort
    Trendcolor := shortColour

// Plotting
plot( showAtr ? DemaAtr : na,  "ATR",  color=Trendcolor,  linewidth = 2 )
// ==========================================================================================

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” ALERT CONDITIONS - Ø´Ø±ÙˆØ· Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ· ÙÙŠ Create Alert ÙÙŠ TradingView
// You can use these conditions in Create Alert in TradingView
// 
// âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø© Ø¬Ø¯Ø§Ù‹:
// ÙƒÙ„ Ø¥Ø´Ø§Ø±Ø© ØªØ±Ø³Ù„ ØªÙ†Ø¨ÙŠÙ‡Ù‡Ø§ Ø§Ù„Ø®Ø§Øµ Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„ ØªÙ…Ø§Ù…Ø§Ù‹:
// - Ø¹Ù†Ø¯Ù…Ø§ ØªØ£ØªÙŠ Ø¥Ø´Ø§Ø±Ø© LONG â†’ ÙŠØ±Ø³Ù„ ØªÙ†Ø¨ÙŠÙ‡ LONG ÙÙ‚Ø· (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù‘Ù„)
// - Ø¹Ù†Ø¯Ù…Ø§ ØªØ£ØªÙŠ Ø¥Ø´Ø§Ø±Ø© SHORT â†’ ÙŠØ±Ø³Ù„ ØªÙ†Ø¨ÙŠÙ‡ SHORT ÙÙ‚Ø· (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù‘Ù„)
// - Ø¹Ù†Ø¯Ù…Ø§ ÙŠØµÙ„ Ø§Ù„Ø³Ø¹Ø± Ù„Ù€ TP1 â†’ ÙŠØ±Ø³Ù„ ØªÙ†Ø¨ÙŠÙ‡ TP1 ÙÙ‚Ø· (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù‘Ù„)
// - ÙˆÙ‡ÙƒØ°Ø§ Ù„ÙƒÙ„ Ø¥Ø´Ø§Ø±Ø©...
//
// âš ï¸ Important Note:
// Each signal sends its own separate alert:
// - When LONG signal appears â†’ sends LONG alert only (if enabled)
// - When SHORT signal appears â†’ sends SHORT alert only (if enabled)
// - When price reaches TP1 â†’ sends TP1 alert only (if enabled)
// - And so on for each signal...
//
// ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
// 1. ÙÙŠ TradingView: Ø£Ù†Ø´Ø¦ ØªÙ†Ø¨ÙŠÙ‡ Ø¬Ø¯ÙŠØ¯ (Create Alert)
// 2. Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±Ø· Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (LONG Signal, SHORT Signal, etc.)
// 3. ÙØ¹Ù‘Ù„/Ø£Ù„ØºÙ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯Ù‡Ø§ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ø´Ø±
// 4. Ø®ØµØµ Ø±Ø³Ø§Ù„Ø© ÙƒÙ„ ØªÙ†Ø¨ÙŠÙ‡ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¤Ø´Ø±
//
// How to Use:
// 1. In TradingView: Create a new alert
// 2. Select the appropriate condition from the list (LONG Signal, SHORT Signal, etc.)
// 3. Enable/disable alerts from indicator settings
// 4. Customize each alert message from indicator settings

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© (8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø© - ÙƒÙ„ Ø¥Ø´Ø§Ø±Ø© ØªØ±Ø³Ù„ ØªÙ†Ø¨ÙŠÙ‡Ù‡Ø§ Ø§Ù„Ø®Ø§Øµ)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Individual Alerts (8 separate alerts - each signal sends its own alert)
// 
// âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø«Ø§Ø¨ØªØ© Ø¨Ø³Ø¨Ø¨ Ù‚ÙŠÙˆØ¯ Pine Script
// ÙŠÙ…ÙƒÙ†Ùƒ ØªØ®ØµÙŠØµ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (customLongMsg, customShortMsg, etc.)
// ÙˆÙ„ÙƒÙ† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙØ¹Ù„ÙŠØ© ÙÙŠ alertcondition Ø«Ø§Ø¨ØªØ© - ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§
//
// Note: Alert messages are fixed due to Pine Script limitations
// You can customize alert messages from settings (customLongMsg, customShortMsg, etc.)
// But the actual messages in alertcondition are fixed - you can modify them manually in the code here

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© (Individual Alerts) - 8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âœ… 8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø© - ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ±Ø³Ù„ Ø¥Ø´Ø§Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
// âœ… 8 separate alerts - each sends one signal type only
//
// ğŸ“Œ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø©:
// - Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª ØªÙ†Ø¨ÙŠÙ‡ Ù…Ù†ÙØµÙ„ Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ø¥Ø´Ø§Ø±Ø© (8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª)
// - ÙƒÙ„ ØªÙ†Ø¨ÙŠÙ‡ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ‚Ù„
// - ÙŠÙ…ÙƒÙ†Ùƒ ØªÙØ¹ÙŠÙ„/ØªØ¹Ø·ÙŠÙ„ ÙƒÙ„ ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù„Ù‰ Ø­Ø¯Ø©
//
// ğŸ“Œ Using Individual Alerts:
// - If you want separate alerts for each signal type (8 alerts)
// - Each alert works independently
// - You can enable/disable each alert separately

// ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ (LONG/BUY) - Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
alertcondition(enableLongAlert and longE, title='ğŸŸ¢ LONG Signal (BUY)', message='SIGNAL:BUY|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¹ (SHORT/SELL) - Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
alertcondition(enableShortAlert and shortE, title='ğŸ”´ SHORT Signal (SELL)', message='SIGNAL:SELL|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¹ÙƒØ³ÙŠ (LONG REVERSE/BUY_REVERSE) - ÙŠÙØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¹ÙƒØ³ ØµÙÙ‚Ø© Short
alertcondition(enableLongReverseAlert and longE_Reverse, title='ğŸŸ  LONG REVERSE Signal (BUY_REVERSE)', message='SIGNAL:BUY_REVERSE|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¹ÙƒØ³ÙŠ (SHORT REVERSE/SELL_REVERSE) - ÙŠÙØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¹ÙƒØ³ ØµÙÙ‚Ø© Long
alertcondition(enableShortReverseAlert and shortE_Reverse, title='ğŸŸ  SHORT REVERSE Signal (SELL_REVERSE)', message='SIGNAL:SELL_REVERSE|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ TP1 - ÙŠÙØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø¹Ø± Ù„Ù€ TP1 (Long Ø£Ùˆ Short)
alertcondition(enableTP1Alert and (longTP1 or shortTP1), title='ğŸ¯ TP1 Hit', message='SIGNAL:TP1_HIT|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ TP2 - ÙŠÙØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø¹Ø± Ù„Ù€ TP2 (Long Ø£Ùˆ Short)
alertcondition(enableTP2Alert and (longTP2 or shortTP2), title='ğŸ¯ TP2 Hit', message='SIGNAL:TP2_HIT|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ TP3 - ÙŠÙØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø¹Ø± Ù„Ù€ TP3 (Long Ø£Ùˆ Short)
alertcondition(enableTP3Alert and (longTP3 or shortTP3), title='ğŸ¯ TP3 Hit', message='SIGNAL:TP3_HIT|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// ØªÙ†Ø¨ÙŠÙ‡ Stop Loss - ÙŠÙØ±Ø³Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø¶Ø±Ø¨ Stop Loss (Long Ø£Ùˆ Short)
alertcondition(enableSLAlert and (longSL or shortSL), title='ğŸ›‘ Stop Loss', message='SIGNAL:STOP_LOSS|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” ØªÙ†Ø¨ÙŠÙ‡ Ù…Ø±ÙƒØ²ÙŠ ÙˆØ§Ø­Ø¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù†Ø¯ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ 8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ø®ØªÙŠØ§Ø±ÙŠ
// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© Ø£Ø¹Ù„Ø§Ù‡ (8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª) Ù‡ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆÙƒÙ„ Ù…Ù†Ù‡Ø§ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ù†ÙØµÙ„
// 
// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ ÙŠØ¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ÙÙŠ ØªÙ†Ø¨ÙŠÙ‡ ÙˆØ§Ø­Ø¯
// Ø§Ø³ØªØ®Ø¯Ù…Ù‡ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ ØªÙ†Ø¨ÙŠÙ‡ ÙˆØ§Ø­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø©
// 
// âš ï¸ Note: This Central Alert is optional
// The individual alerts above (8 alerts) are the main ones and each works separately
// 
// Central Alert combines all signals into one alert
// Use it only if you want one alert for all signals instead of 8 separate alerts
// 
// Ù…Ù„Ø§Ø­Ø¸Ø©: ÙÙŠ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù…:
// {{ticker}} - Ø§Ø³Ù… Ø§Ù„Ø±Ù…Ø² | {{close}} - Ø³Ø¹Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ | {{time}} - Ø§Ù„ÙˆÙ‚Øª | {{volume}} - Ø§Ù„Ø­Ø¬Ù…
// 
// Note: In the central alert message, you can use:
// {{ticker}} - Symbol name | {{close}} - Close price | {{time}} - Time | {{volume}} - Volume

// ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ)
// ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø£ÙŠ Ø¥Ø´Ø§Ø±Ø© Ù…ÙØ¹Ù‘Ù„Ø© Ù‚Ø¯ ØªÙ… ØªÙØ¹ÙŠÙ„Ù‡Ø§
anyAlertTriggered = (enableLongAlert and longE) or (enableShortAlert and shortE) or (enableLongReverseAlert and longE_Reverse) or (enableShortReverseAlert and shortE_Reverse) or (enableTP1Alert and (longTP1 or shortTP1)) or (enableTP2Alert and (longTP2 or shortTP2)) or (enableTP3Alert and (longTP3 or shortTP3)) or (enableSLAlert and (longSL or shortSL))

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø°ÙƒÙŠ - ØªÙ†Ø¨ÙŠÙ‡ ÙˆØ§Ø­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª (8 Ø£Ù†ÙˆØ§Ø¹)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âœ… ØªÙ†Ø¨ÙŠÙ‡ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙŠØ­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆÙŠ sends Ø±Ø³Ø§Ù„Ø© Ù…Ù†ÙØµÙ„Ø© Ù„ÙƒÙ„ Ù†ÙˆØ¹
// âœ… Smart Central Alert - One alert that auto-detects signal type and sends separate messages
//
// ğŸ“Œ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø© ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ:
// - Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø©: 8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø© (ÙƒÙ„ ÙˆØ§Ø­Ø¯ Ù„Ø¥Ø´Ø§Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
// - Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ: ØªÙ†Ø¨ÙŠÙ‡ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙŠØ±Ø³Ù„ Ø±Ø³Ø§Ø¦Ù„ Ù…Ù†ÙØµÙ„Ø© Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ø¥Ø´Ø§Ø±Ø© (8 Ø£Ù†ÙˆØ§Ø¹)
//
// ğŸ“Œ Ø§Ù„ÙØ±Ù‚ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
// - Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø©: Ø£Ù†Ø´Ø¦ 8 ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙÙŠ TradingView (ÙˆØ§Ø­Ø¯ Ù„ÙƒÙ„ Ù†ÙˆØ¹)
// - Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ: Ø£Ù†Ø´Ø¦ ØªÙ†Ø¨ÙŠÙ‡ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·ØŒ ÙˆØ³ÙŠØ±Ø³Ù„ Ø±Ø³Ø§Ø¦Ù„ Ù…Ù†ÙØµÙ„Ø© Ù„ÙƒÙ„ Ù†ÙˆØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
//
// ğŸ“Œ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ:
// 1. Ø¹Ù†Ø¯Ù…Ø§ ØªØ¸Ù‡Ø± Ø£ÙŠ Ø¥Ø´Ø§Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Øª (BUY, SELL, REVERSE, TP, SL)
// 2. Ø§Ù„Ù…Ø¤Ø´Ø± ÙŠØ­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… (1-8)
// 3. Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ÙŠØ±Ø³Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
// 4. Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (main.py) ÙŠÙ‚Ø±Ø£ Ø§Ù„Ø±Ù‚Ù… ÙˆÙŠØ­ÙˆÙ„Ù‡ Ø¥Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø¥Ø´Ø§Ø±Ø©
// 5. Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠØ±Ø³Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© (Ù…Ù†ÙØµÙ„Ø©) Ø¥Ù„Ù‰ Telegram Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ø¥Ø´Ø§Ø±Ø©
//
// ğŸ“Œ ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
// 1. ÙÙŠ TradingViewØŒ Ø§Ø¨Ø­Ø« Ø¹Ù† "ğŸ”” Smart Central Alert - All Signals"
// 2. Ø§Ø®ØªØ± Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
// 3. ÙÙŠ Message fieldØŒ Ø§Ø³ØªØ®Ø¯Ù… JSON format (Ø§Ù†Ø¸Ø± Ø£Ø¯Ù†Ø§Ù‡)
// 4. Ø³ÙŠØ±Ø³Ù„ Ø±Ø³Ø§Ø¦Ù„ Ù…Ù†ÙØµÙ„Ø© Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ø¥Ø´Ø§Ø±Ø© (BUY, SELL, REVERSE, TP1, TP2, TP3, SL)
//
// ğŸ“Œ How to use:
// 1. In TradingView, search for "ğŸ”” Smart Central Alert - All Signals"
// 2. Select this single alert only
// 3. In Message field, use JSON format (see below)
// 4. It will send separate messages for each signal type (BUY, SELL, REVERSE, TP1, TP2, TP3, SL)

// ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… (Signal Type Code)
// ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Øª ÙÙŠ ÙƒÙ„ Ø´Ù…Ø¹Ø©
// 1 = BUY, 2 = SELL, 3 = BUY_REVERSE, 4 = SELL_REVERSE, 5 = TP1, 6 = TP2, 7 = TP3, 8 = STOP_LOSS
//
// âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: ÙÙŠ Ø£ÙŠ Ø´Ù…Ø¹Ø© Ù…Ø¹ÙŠÙ†Ø©ØŒ Ù„Ù† ØªÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø¥Ù„Ø§ Ø¥Ø´Ø§Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
// Ù„Ø°Ù„Ùƒ ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØªØ§Ù„ÙŠ:
// - REVERSE Ø£ÙˆÙ„Ø§Ù‹ (Ù„Ø£Ù†Ù‡ Ù‚Ø¯ ÙŠØ­Ø¯Ø« Ù…Ø¹ Ø¥Ø´Ø§Ø±Ø§Øª Ø£Ø®Ø±Ù‰)
// - Ø«Ù… Entry signals (BUY/SELL)
// - Ø«Ù… TP signals (TP1, TP2, TP3)
// - Ø«Ù… Stop Loss
// ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ternary operator (Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Pine Script)
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† REVERSE Ø£ÙˆÙ„Ø§Ù‹ (Ù„Ø£Ù†Ù‡ Ù‚Ø¯ ÙŠØ­Ø¯Ø« Ù…Ø¹ Ø¥Ø´Ø§Ø±Ø§Øª Ø£Ø®Ø±Ù‰)
// Ø«Ù… Entry signals Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
// Ø«Ù… TP signals (Ù…Ù† Ø§Ù„Ø£ÙƒØ¨Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø£ØµØºØ±)
// Ø«Ù… Stop Loss
signalTypeCode = (enableLongReverseAlert and longE_Reverse) ? 3 : (enableShortReverseAlert and shortE_Reverse) ? 4 : (enableLongAlert and longE) ? 1 : (enableShortAlert and shortE) ? 2 : (enableTP3Alert and (longTP3 or shortTP3)) ? 7 : (enableTP2Alert and (longTP2 or shortTP2)) ? 6 : (enableTP1Alert and (longTP1 or shortTP1)) ? 5 : (enableSLAlert and (longSL or shortSL)) ? 8 : 0

// Plot Ù„Ù„Ù€ Signal Type Code (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡)
// Ù†Ø³ØªØ®Ø¯Ù… plot value Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ alertcondition
// Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… ÙŠØ­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø§Ù„ØªÙŠ Ø¸Ù‡Ø±Øª Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Øª
p_signalTypeCode = plot(signalTypeCode > 0 ? signalTypeCode : na, title="Signal Type Code", display=display.none)

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„ÙˆØ§Ø­Ø¯ - ÙŠØ¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª
// âœ… ÙŠØ¹Ù…Ù„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø±Øª
// âœ… ÙŠØ­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆÙŠ sends Ø±Ø³Ø§Ù„Ø© Ù…Ø®ØªÙ„ÙØ© Ù„ÙƒÙ„ Ù†ÙˆØ¹
// âœ… ÙŠØ³ØªØ®Ø¯Ù… plot value Ù…Ø¨Ø§Ø´Ø±Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©
// Ù‡Ø°Ø§ Ø§Ù„Ø´Ø±Ø· ÙŠØ¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª (BUY, SELL, REVERSE, TP, SL)
alertcondition(anyAlertTriggered, title='ğŸ”” Smart Central Alert - All Signals', message='SIGNAL_CODE:{{plot("Signal Type Code")}}|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”” Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© Ø§Ù„ÙØ±Ø¯ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© - Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© Ø£Ø¯Ù†Ø§Ù‡ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ù†ÙØµÙ„Ø© Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ø¥Ø´Ø§Ø±Ø©
// You can use the individual alerts below if you want separate alerts for each signal type

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - BUY (Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡)
// alertcondition(enableLongAlert and longE, title='ğŸ”” Central - BUY', message='SIGNAL:BUY|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - SELL (Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¹)
// alertcondition(enableShortAlert and shortE, title='ğŸ”” Central - SELL', message='SIGNAL:SELL|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - BUY REVERSE (Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ø¹ÙƒØ³ÙŠØ©)
// alertcondition(enableLongReverseAlert and longE_Reverse, title='ğŸ”” Central - BUY REVERSE', message='SIGNAL:BUY_REVERSE|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - SELL REVERSE (Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¹ÙƒØ³ÙŠØ©)
// alertcondition(enableShortReverseAlert and shortE_Reverse, title='ğŸ”” Central - SELL REVERSE', message='SIGNAL:SELL_REVERSE|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - TP1 (ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£ÙˆÙ„)
// alertcondition(enableTP1Alert and (longTP1 or shortTP1), title='ğŸ”” Central - TP1', message='SIGNAL:TP1_HIT|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - TP2 (ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø«Ø§Ù†ÙŠ)
// alertcondition(enableTP2Alert and (longTP2 or shortTP2), title='ğŸ”” Central - TP2', message='SIGNAL:TP2_HIT|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - TP3 (ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø«Ø§Ù„Ø«)
// alertcondition(enableTP3Alert and (longTP3 or shortTP3), title='ğŸ”” Central - TP3', message='SIGNAL:TP3_HIT|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - STOP LOSS (ÙˆÙ‚Ù Ø§Ù„Ø®Ø³Ø§Ø±Ø©)
// alertcondition(enableSLAlert and (longSL or shortSL), title='ğŸ”” Central - STOP LOSS', message='SIGNAL:STOP_LOSS|SYMBOL:{{ticker}}|PRICE:{{close}}|TIME:{{time}}|TF:{{interval}}')

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš ï¸ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹: Ø¹Ù†Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© Ø£Ø¹Ù„Ø§Ù‡ØŒ ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… JSON format
// ÙÙŠ TradingView Alert Message field Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (TP/SL)
//
// âš ï¸ IMPORTANT: When using Central Alerts above, you MUST use JSON format
// in TradingView Alert Message field to get all data (TP/SL)
//
// JSON Format Ù„Ù„Ø¥Ø´Ø§Ø±Ø§Øª (Entry Signals - BUY/SELL/REVERSE):
// {"signal":"BUY","symbol":"{{ticker}}","entry_price":{{close}},"tp1":{{plot("TP Line 1")}},"tp2":{{plot("TP Line 2")}},"tp3":{{plot("TP Line 3")}},"stop_loss":{{plot("SL Line")}},"time":"{{time}}","timeframe":"{{interval}}"}
//
// JSON Format Ù„Ù„Ù€ TP:
// {"signal":"TP1_HIT","symbol":"{{ticker}}","entry_price":{{plot("Entry Line")}},"exit_price":{{close}},"tp1":{{plot("TP Line 1")}},"time":"{{time}}","timeframe":"{{interval}}"}
//
// JSON Format Ù„Ù„Ù€ Stop Loss:
// {"signal":"STOP_LOSS","symbol":"{{ticker}}","price":{{close}},"time":"{{time}}","timeframe":"{{interval}}"}
